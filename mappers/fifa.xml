<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="FIFA">


<!-- 	Image Convert	 -->

	<select id="image_convert" parameterType="int" resultType="_byte[]">
	
		SELECT
			img
		FROM
			Image
		WHERE
			img_no = #{no}
			
	</select>
	
	
<!-- 	Login	 -->

	<select id="login" parameterType="String" resultType="map">
	
		SELECT
			*
		FROM
			FIFA
		WHERE
			id = #{id}
			
	</select>
	
	
<!-- 	Join	 -->

	<insert id="join" parameterType="map">
	
		INSERT
			INTO FIFA (
				id,
				pw,
				name,
				role
			)
			VALUES (
				#{id},
				#{pw},
				#{name},
				#{role}
			);
			
		<if test="role == 'Club'">
			
			INSERT
				INTO Image (
					img
				)
				VALUES (
					#{img1}
				);
				
			INSERT
				INTO Stadium (
					std_name,
					std_img
				)
				VALUES (
					#{stadium},
					LAST_INSERT_ID()
				);
				
			INSERT
				INTO Image (
					img
				)
				VALUES (
					#{img}
				);
				
			INSERT
				INTO Club (
					name,
					emblem,
					anchorage,
					stadium
				)
				VALUES (
					#{name},
					LAST_INSERT_ID(),
					#{anchorage},
					#{stadium}
				)
				
		</if>
		<if test="role == 'Manager'">
		
			INSERT
				INTO Image (
					img
				)
				VALUES (
					#{img}
				);
			INSERT
				INTO Manager (
					name,
					profile,
					country,
					birth,
					height,
					weight,
					ovr,
					tactic
				)
				VALUES (
					#{name},
					LAST_INSERT_ID(),
					#{country},
					#{birth},
					#{height},
					#{weight},
					#{ovr},
					#{tactic}
				)
				
		</if>
		<if test="role == 'Player'">
		
			INSERT
				INTO Image (
					img
				)
				VALUES (
					#{img}
				);
			INSERT
				INTO Player (
					name,
					profile,
					country,
					birth,
					height,
					weight,
					ovr,
					position
				)
				VALUES (
					#{name},
					LAST_INSERT_ID(),
					#{country},
					#{birth},
					#{height},
					#{weight},
					#{ovr},
					#{position}
				)
		
		</if>
		
	</insert>
	
	
<!-- 	리그 로스터	 -->

	<select id="infoleague" resultType="map">
	
		SELECT
			*
		FROM
			League
	
	</select>
	
	
<!-- 	로스터 등록	 -->

	<update id="updateroster" parameterType="String">
	
		UPDATE
			League
		SET
			roster = #{rosterlist}
		WHERE
			name = 'Legend League'
		
	</update>
	
	
<!--	 FIFA List		-->
	
	<select id="list" parameterType="map" resultType="map">
	
		SELECT
			*
		FROM
			${role}
			
			<if test="role == null">
			
				Club
				
			</if>
			
		ORDER BY
			name ASC
			
	</select>
	
	
<!-- 	클럽 정보	 -->

	<select id="infoclub" parameterType="map" resultType="map">
	
		SELECT
			*
		FROM
			Club
		WHERE
			name = #{name}
			
	</select>
	
	
<!-- 	감독 정보	 -->

	<select id="infomanager" parameterType="map" resultType="map">
	
		SELECT
			name,
			country,
			birth,
			height,
			weight,
			ovr,
			tactic
		FROM
			Manager
		WHERE
			name = #{name}
			
	</select>
	
	
<!-- 	선수 정보	 -->

	<select id="infoplayer" parameterType="map" resultType="map">
	
		SELECT
			name,
			profile,
			country,
			birth,
			height,
			weight,
			ovr,
			history,
			club
		FROM
			Player
		WHERE
			name = #{name}
			
	</select>
	
	
<!-- 	로스터  등록 클럽	 -->

	<update id="updaterosterclubclear">
	
		UPDATE
			Club
		SET
			roster = 0
		
	</update>
	<update id="updaterosterclub" parameterType="String">
	
		UPDATE
			Club
		SET
			roster = 1
		WHERE
			name = #{rosterlist}
		
	</update>
</mapper>